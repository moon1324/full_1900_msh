<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>종합 실습 01</title>
    <style>
        table, div {
            width: 800px;
            margin: 0 auto;
            border: 1px solid gray;
            border-collapse: collapse;
        }

        div {
            text-align: center;
        }

        input {
            width: 130px;
        }

        td, th {
            border: 1px solid gray;
        }
    </style>
</head>
<body>
    <button id="list-button">데이터 가져오기</button>
    <button id="write-button">데이터 추가하기</button>
    <div>
        <input type="text" id="name" placeholder="이름">
        <input type="text" id="city" placeholder="시.도">
        <input type="text" id="street" placeholder="구.군.동">
        <input type="text" id="suite" placeholder="상세주소2">
        <input type="text" id="zipcode" placeholder="우편주소">
    </div>
    <table class="user-table">
        <thead>
            <tr>
                <th>id</th>
                <th>name</th>
                <th>street</th>
                <th>suite</th>
                <th>city</th>
                <th>zipcode</th>
            </tr>
        <thead>
        <tbody></tbody>
    </table>
</body>
<script src="service01.js"></script>
<script src="layout01.js"></script>
<script>
    const listButton = document.getElementById("list-button");
    const writeButton = document.getElementById("write-button");
    const tbody = document.querySelector("table.user-table tbody");
    
    const listButtonClickEvent = async (e) => {
        const text = await userService.findAll(userLayout.showList);
        tbody.innerHTML = text;
    }

    const writeButtonClickEvent = async (e) => {
        // 사용자가 화면에 입력한 정보 가져오기
        const name = document.getElementById("name").value;
        const street = document.getElementById("street").value;
        const suite = document.getElementById("suite").value;
        const city = document.getElementById("city").value;
        const zipcode = document.getElementById("zipcode").value;

        // 객체화
        const createdUser = {
            name: name,
            street: street,
            suite: suite,
            city: city,
            zipcode: zipcode
        }

        // 서버에 전달해서 회원을 추가하고,
        // 새롭게 추가된 회원 정보를 tr태그 문자열 값으로 전달받는다.
        const newText = await userService.create(createdUser, userLayout.showUser)
        
        // 전체 목록
        const text = await userService.findAll(userLayout.showList);
        
        // 화면 출력
        // 전체 목록 출력
        tbody.innerHTML = text;
        // 그 뒤에 새롭게 추가된 회원 출력
        tbody.innerHTML += newText;
    }


    // 리팩토링
    listButton.addEventListener("click", listButtonClickEvent);
    writeButton.addEventListener("click", writeButtonClickEvent);
</script>
</html>
<!-- <!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>종합 실습 01</title>
        <style>
            table,
            div {
                width: 800px;
                margin: 0 auto;
                border: 1px solid gray;
                border-collapse: collapse;
            }
            div {
                text-align: center;
            }
            input {
                width: 130px;
            }
            td,
            th {
                border: 1px solid gray;
            }
        </style>
    </head>
    <body>
        <button id="list-button">데이터 가져오기</button>
        <button id="write-button">데이터 추가하기</button>
        <div>
            <input type="text" id="name" placeholder="이름" />
            <input type="text" id="city" placeholder="시/도" />
            <input type="text" id="street" placeholder="도로명" />
            <input type="text" id="suite" placeholder="상세주소" />
            <input type="text" id="zipcode" placeholder="우편주소" />
        </div>

        <table class="user-table">
            <thead>
                <tr>
                    <th>id</th>
                    <th>name</th>
                    <th>street</th>
                    <th>suite</th>
                    <th>city</th>
                    <th>zipcode</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </body>
    <script src="service01.js"></script>
    <script src="layout01.js"></script>
    <script>
        const listButton = document.getElementById("list-button");
        const writeButton = document.getElementById("write-button");
        // listButton.addEventListener("click", (e) => {
        //     userService.findAll(userLayout.showList);
        // });
        const listButtonClickEvent = (e) => {
            userService.findAll(userLayout.showList);
        };

        const writeButtonClickEvent = async (e) => {
            // 사용자가 화면에 입력한 정보 가져오기
            const name = document.getElementById("name").value;
            const city = document.getElementById("city").value;
            const street = document.getElementById("street").value;
            const suite = document.getElementById("suite").value;
            const zipcode = document.getElementById("zipcode").value;

            // 회원가입
            // CRUD중 C(Create)를 요청
            const response = await fetch(
                "https://jsonplaceholder.typicode.com/posts",
                {
                    method: "post",
                    body: JSON.stringify({
                        name: name,
                        street: street,
                        suite: suite,
                        city: city,
                        zipcode: zipcode,
                    }),
                    headers: {
                        "Content-Type": "application/json; charset=utf-8",
                    },
                }
            );

            const user = await response.json();
        };

        // 리팩토링
        listButton.addEventListener("click", listButtonClickEvent);
        writeButton.addEventListener("click", writeButtonClickEvent);

        // // 버튼 가져오기
        // const button = document.querySelector("button");
        // // 데이터가 출력될 부분(tbody)
        // const tbody = document.querySelector("table.user-table tbody");

        // // button에 이벤트 리스너를 주고
        // // 클릭하면 뒤의 함수가 실행된다
        // // 함수에 async가 붙어있으니 비동기로 진행된다
        // button.addEventListener("click", async (e) => {
        //     // 서버에 데이터 GET방식(default) 요청
        //     // 요청할때는 주소 뒤에 method라는 키값으로 원하는 method를 보낼수 있다
        //     const response = await fetch(
        //         "https://jsonplaceholder.typicode.com/users",
        //         { method: "get" }
        //     );
        //     // 서버로부터 응답받은 데이터를 javascript 객체로 변환
        //     const users = await response.json();
        //     // 위 코드가 다 service01.js로 모듈화된다.
        //     // 화면에 뿌릴 정보를 담을 text
        //     let text = ``;
        //     // 각 회원별 정보를 추출한다.
        //     users.forEach((user) => {
        //         // 회원정보 하나당 tr 하나씩 누적연결
        //         text += `
        //         <tr>
        //             <td>${user.id}</td>
        //             <td>${user.name}</td>
        //             <td>${user.address.street}</td>
        //             <td>${user.address.suite}</td>
        //             <td>${user.address.city}</td>
        //             <td>${user.address.zipcode}</td>
        //         </tr>
        //         `;
        //     });
        //     // 위에서 누적된 회원의 정보를 tbody를 통해 출럭해준다.
        //     // 누적연결한 text를 tbody.innerHTML로 일괄처리
        //     tbody.innerHTML = text;
        // });
    </script>
</html> -->